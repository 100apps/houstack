# HouStack简介

`HouStack`是一个模仿[XAMPP](https://www.apachefriends.org/zh_cn/index.html)的运行环境，解压即用。

在开发[寓悦](https://www.houpix.com)APP的过程中，我们后端主要用到了PHP、java、python、nodejs、go等语言，开发、测试、灰度、线上环境有一个基本的要求是程序运行环境必需一致，应该杜绝因为类似PHP版本不一致导致的人为bug。一开始我们用`yum groupinstall 'Development Tools'`的方法在每台机器上安装编译环境，然后下载对应版本的源代码进行编译，这样基本上可以解决问题，但是太low了，因为每台机器上都要编译，而且不好移植，有时候每次编译都有可能遇到各种各样的问题。`XAMPP`给了我们灵感，我们想做一个通用的64位Linux上运行的环境，只需要解压缩，所有的环境就都有了。

这样，我们的服务器被分成以下几个部分：

```
+-----------+-------------+
|           |             |
|           |             |
|           |             |
|           |             |
|           |             |
| 配置文件   |  应用层      |
|           |             |
|           |             |
|           |             |
|           |             |
+-----------+-------------+
|                         |
|                         |
|        HouStack层       |
|                         |
+-------------------------+
|                         |
|                         |
|        操作系统层        |
|                         |
+-------------------------+


```

正如某位伟人所说：

> Any problem  in computer science can be solved by anther layer of indirection.

为了增加应用层的可移植性，我们在操作系统上面添加了一个HouStack层，用来屏蔽各个发行版本的区别。这并没有什么稀奇的，因为各个运行环境都是跨平台的。HouStack的意义在于，它本身解压就能用，除了基础的libc以外，基本上没有更多依赖。

在开发、测试、生产环境中，应用层的东西是完全一样的，没有任何区别。差别仅在于“配置文件”层。开发环境是DEBUG模式，有更详细的日志，测试和生产保持完全一致(除了机器配置以外，完全一样，[参考](http://www.gfzj.us/2016/07/11/info-in-url.html))。

当然，你也可以用Docker保证各个运行环境保持一致。但是Docker根本不适合开发环境，而且在微服务的情况下，各种依赖，各种语言，非常不适合开发。

还记得为什么Google把所有代码放到一个仓库里面吗？[谷歌的代码管理](http://www.ruanyifeng.com/blog/2016/07/google-monolithic-source-repository.html)

我们所有语言，所有项目都放在应用层的目录里面，开发环境中可以很方便的把所有的服务都启动，一个虚拟机可以跑通所有的服务。但是这并不代表不可以分布式。我们部署的时候，只需要根据需要配置访问路径和负载均衡就可以了。

当然，除了一个完整的解压就可以用的HouStack压缩包以外，这里主要还提供了构建的方法，可以给大家参考。